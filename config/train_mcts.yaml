# @package _global_
# config/train_mcts.yaml

defaults:
  - _self_ # Allows values defined here to be defaults
#  - override hydra/job_logging: colorlog # Optional: for nicer logging
#  - override hydra/hydra_logging: colorlog # Optional: for nicer logging

hydra:
  run:
    dir: outputs/mcts_train/${now:%Y-%m-%d}/${now:%H-%M-%S}
  sweep:
    dir: multirun/mcts_train/${now:%Y-%m-%d}/${now:%H-%M-%S}
    subdir: ${hydra.job.num}

# Target the main Config dataclass
_target_: MCTS.config_schema.Config

network:
  # Target the specific NetworkConfig dataclass
  _target_: MCTS.config_schema.NetworkConfig
  # Values here override defaults in the dataclass
  input_channels: 10
  board_size: 8
  num_conv_layers: 4
  num_filters: 64 # Example override
  # piece_embedding_dim: 64 # Add if needed by network
  # interaction_dim: 128   # Add if needed by network
  num_attention_heads: 8 # Example override
  decoder_ff_dim_mult: 4

mcts:
  _target_: MCTS.config_schema.MCTSConfig
  iterations: 100
  c_puct: 1.41
  temperature_start: 1.0
  temperature_end: 0.1
  temperature_decay_moves: 30

optimizer:
  _target_: MCTS.config_schema.OptimizerConfig
  type: Adam
  learning_rate: 0.001
  # momentum: 0.9 # Not needed for Adam default
  weight_decay: 1e-4

training:
  _target_: MCTS.config_schema.TrainingConfig
  device: auto
  replay_buffer_size: 50000
  batch_size: 128
  self_play_games_per_epoch: 50
  training_epochs: 10
  num_training_iterations: 1000
  checkpoint_dir: ${hydra:run.dir}/checkpoints # Relative to hydra output
  save_interval: 10
  max_game_moves: 200
  board_cls_str: chess_gym.chess_custom.FullyTrackedBoard
  action_space_size: 850 # Network needs this 